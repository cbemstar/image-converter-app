<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Authentication System</title>
    <link rel="stylesheet" href="styles/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-background p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">Authentication System Test</h1>
        
        <div class="card p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Usage Counter</h2>
            <div id="usage-counter" class="mb-4"></div>
            
            <div class="flex gap-4">
                <button onclick="testConversion()" class="btn btn-primary">
                    Test Conversion
                </button>
                <button onclick="window.resetUsage()" class="btn btn-outline">
                    Reset Usage
                </button>
                <button onclick="showStatus()" class="btn btn-outline">
                    Show Status
                </button>
            </div>
        </div>
        
        <div class="card p-6">
            <h2 class="text-xl font-bold mb-4">Test Results</h2>
            <div id="test-results" class="space-y-2"></div>
        </div>
    </div>

    <script src="tools/image-converter/auth-simple.js"></script>
    <script>
        function addResult(message, type = 'info') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `p-2 rounded ${type === 'success' ? 'bg-green-100 text-green-800' : 
                                         type === 'error' ? 'bg-red-100 text-red-800' : 
                                         'bg-blue-100 text-blue-800'}`;
            div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }

        function testConversion() {
            if (window.canConvert()) {
                window.recordConversion();
                addResult('Conversion successful! Usage recorded.', 'success');
            } else {
                addResult('Conversion blocked - limit reached!', 'error');
                window.showUpgradeModal();
            }
        }

        function showStatus() {
            if (window.imageAuth) {
                const remaining = window.imageAuth.getRemainingConversions();
                const used = window.imageAuth.usageCount;
                const limit = window.imageAuth.freeLimit;
                addResult(`Status: ${used}/${limit} used, ${remaining} remaining`, 'info');
            } else {
                addResult('Auth system not available', 'error');
            }
        }

        // Initialize display
        setTimeout(() => {
            if (window.imageAuth) {
                window.imageAuth.updateUI();
                addResult('Authentication system initialized', 'success');
                showStatus();
            } else {
                addResult('Failed to initialize auth system', 'error');
            }
        }, 100);
    </script>
</body>
</html>